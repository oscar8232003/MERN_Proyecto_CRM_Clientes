{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\oscar\\\\Desktop\\\\Node\\\\Node_ReactJS\\\\Front-end-app\\\\src\\\\components\\\\productos\\\\EditarProducto.js\";\nimport React, { useState, useEffect } from \"react\";\nimport clienteAxios from \"../../config/axios\";\nimport Swal from \"sweetalert2\";\nimport { withRouter } from \"react-router-dom\";\nimport Spinner from \"../layout/Spinner\";\nimport { verificacionToken } from \"../../config/jwt\";\n\nconst EditarProducto = props => {\n  //Obtener id del producto\n  const {\n    id\n  } = props.match.params; //States\n\n  const [producto, setProducto] = useState({\n    nombre: \"\",\n    precio: \"\",\n    imagen: \"\"\n  });\n  const [archivo, setArchivo] = useState(\"\");\n  const [usuario, setUsuario] = useState({}); //Traemos el Token del localStorage, tiene que ser directo sino toma el token expirado\n\n  const Token = localStorage.getItem(\"token\"); //Verificamos el Token si es valido o no\n\n  const verificar = verificacionToken(Token); //Consultar la API\n\n  const consultarAPI = async () => {\n    const productoConsulta = await clienteAxios.get(`/productos/${id}`, {\n      headers: {\n        Authorization: `Bearer ${Token}`\n      }\n    });\n    setProducto(productoConsulta.data);\n  };\n\n  useEffect(() => {\n    if (verificar.error) {\n      props.history.push(\"/iniciar-sesion\");\n    }\n\n    setUsuario(verificar);\n    consultarAPI();\n  }, []); //Editar el producto\n\n  const handleSubmit = async e => {\n    e.preventDefault();\n\n    if (!producto.nombre || !producto.precio || !producto.imagen) {\n      Swal.fire({\n        icon: \"error\",\n        title: \"Lo siento, todos los campos deben estar llenos\",\n        text: \"\"\n      });\n      return null;\n    } // crear un formdata\n\n\n    const formData = new FormData();\n    formData.append(\"nombre\", producto.nombre);\n    formData.append(\"precio\", producto.precio);\n    formData.append(\"imagen\", archivo); // almacenarlo en la BD\n\n    try {\n      const res = await clienteAxios.put(`/productos/${producto._id}`, formData, {\n        headers: {\n          \"Content-Type\": \"multipart/form-data\",\n          Authorization: `Bearer ${Token}`\n        }\n      }); // Lanzar una alerta\n\n      if (res.status === 200) {\n        Swal.fire(\"Editado Correctamente\", res.data.mensaje, \"success\");\n      } // redireccionar\n\n\n      props.history.push(\"/productos\");\n    } catch (error) {\n      console.log(error); // lanzar alerta\n\n      Swal.fire({\n        icon: \"error\",\n        title: \"Hubo un error\",\n        text: \"Vuelva a intentarlo\"\n      });\n\n      if (verificar.error) {\n        props.history.push(\"/iniciar-sesion\");\n      }\n    }\n  }; //Leer informacion de los inputs de texto/enteros\n\n\n  const leerInformacionProducto = e => {\n    setProducto({ ...producto,\n      [e.target.name]: e.target.value\n    });\n  }; //Coloca la imagen en el state\n\n\n  const leerArchivo = e => {\n    setArchivo(e.target.files[0]);\n  }; //Spinner de Carga\n\n\n  if (!producto.nombre) {\n    return React.createElement(Spinner, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111\n      },\n      __self: this\n    });\n  }\n\n  return React.createElement(React.Fragment, null, React.createElement(\"h2\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116\n    },\n    __self: this\n  }, \"Editar Producto\"), React.createElement(\"form\", {\n    onSubmit: handleSubmit,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118\n    },\n    __self: this\n  }, React.createElement(\"legend\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119\n    },\n    __self: this\n  }, \"Llena todos los campos\"), React.createElement(\"div\", {\n    className: \"campo\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121\n    },\n    __self: this\n  }, React.createElement(\"label\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122\n    },\n    __self: this\n  }, \"Nombre:\"), React.createElement(\"input\", {\n    type: \"text\",\n    placeholder: \"Nombre Producto\",\n    name: \"nombre\",\n    onChange: leerInformacionProducto,\n    defaultValue: producto.nombre,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123\n    },\n    __self: this\n  })), React.createElement(\"div\", {\n    className: \"campo\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132\n    },\n    __self: this\n  }, React.createElement(\"label\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133\n    },\n    __self: this\n  }, \"Precio:\"), React.createElement(\"input\", {\n    type: \"number\",\n    name: \"precio\",\n    min: \"0.00\",\n    step: \"0.01\",\n    placeholder: \"Precio\",\n    onChange: leerInformacionProducto,\n    defaultValue: producto.precio,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134\n    },\n    __self: this\n  })), React.createElement(\"div\", {\n    className: \"campo\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145\n    },\n    __self: this\n  }, React.createElement(\"label\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146\n    },\n    __self: this\n  }, \"Imagen:\"), producto.imagen ? React.createElement(\"img\", {\n    src: `http://localhost:5000/${producto.imagen}`,\n    alt: producto.imagen,\n    width: \"300\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 148\n    },\n    __self: this\n  }) : null, React.createElement(\"input\", {\n    type: \"file\",\n    name: \"imagen\",\n    onChange: leerArchivo,\n    onChange: leerArchivo,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154\n    },\n    __self: this\n  })), React.createElement(\"div\", {\n    className: \"enviar\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162\n    },\n    __self: this\n  }, React.createElement(\"input\", {\n    type: \"submit\",\n    className: \"btn btn-azul\",\n    value: \"Agregar Producto\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163\n    },\n    __self: this\n  }))));\n};\n\nexport default withRouter(EditarProducto);","map":{"version":3,"sources":["C:/Users/oscar/Desktop/Node/Node_ReactJS/Front-end-app/src/components/productos/EditarProducto.js"],"names":["React","useState","useEffect","clienteAxios","Swal","withRouter","Spinner","verificacionToken","EditarProducto","props","id","match","params","producto","setProducto","nombre","precio","imagen","archivo","setArchivo","usuario","setUsuario","Token","localStorage","getItem","verificar","consultarAPI","productoConsulta","get","headers","Authorization","data","error","history","push","handleSubmit","e","preventDefault","fire","icon","title","text","formData","FormData","append","res","put","_id","status","mensaje","console","log","leerInformacionProducto","target","name","value","leerArchivo","files"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport clienteAxios from \"../../config/axios\";\r\nimport Swal from \"sweetalert2\";\r\nimport { withRouter } from \"react-router-dom\";\r\nimport Spinner from \"../layout/Spinner\";\r\nimport { verificacionToken } from \"../../config/jwt\";\r\n\r\nconst EditarProducto = props => {\r\n  //Obtener id del producto\r\n  const { id } = props.match.params;\r\n\r\n  //States\r\n  const [producto, setProducto] = useState({\r\n    nombre: \"\",\r\n    precio: \"\",\r\n    imagen: \"\"\r\n  });\r\n  const [archivo, setArchivo] = useState(\"\");\r\n  const [usuario, setUsuario] = useState({});\r\n\r\n  //Traemos el Token del localStorage, tiene que ser directo sino toma el token expirado\r\n  const Token = localStorage.getItem(\"token\");\r\n  //Verificamos el Token si es valido o no\r\n  const verificar = verificacionToken(Token);\r\n\r\n  //Consultar la API\r\n  const consultarAPI = async () => {\r\n    const productoConsulta = await clienteAxios.get(`/productos/${id}`, {\r\n      headers: {\r\n        Authorization: `Bearer ${Token}`\r\n      }\r\n    });\r\n    setProducto(productoConsulta.data);\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (verificar.error) {\r\n      props.history.push(\"/iniciar-sesion\");\r\n    }\r\n    setUsuario(verificar);\r\n    consultarAPI();\r\n  }, []);\r\n\r\n  //Editar el producto\r\n  const handleSubmit = async e => {\r\n    e.preventDefault();\r\n    if (!producto.nombre || !producto.precio || !producto.imagen) {\r\n      Swal.fire({\r\n        icon: \"error\",\r\n        title: \"Lo siento, todos los campos deben estar llenos\",\r\n        text: \"\"\r\n      });\r\n      return null;\r\n    }\r\n\r\n    // crear un formdata\r\n    const formData = new FormData();\r\n    formData.append(\"nombre\", producto.nombre);\r\n    formData.append(\"precio\", producto.precio);\r\n    formData.append(\"imagen\", archivo);\r\n\r\n    // almacenarlo en la BD\r\n    try {\r\n      const res = await clienteAxios.put(\r\n        `/productos/${producto._id}`,\r\n        formData,\r\n        {\r\n          headers: {\r\n            \"Content-Type\": \"multipart/form-data\",\r\n            Authorization: `Bearer ${Token}`\r\n          }\r\n        }\r\n      );\r\n\r\n      // Lanzar una alerta\r\n      if (res.status === 200) {\r\n        Swal.fire(\"Editado Correctamente\", res.data.mensaje, \"success\");\r\n      }\r\n\r\n      // redireccionar\r\n      props.history.push(\"/productos\");\r\n    } catch (error) {\r\n      console.log(error);\r\n      // lanzar alerta\r\n      Swal.fire({\r\n        icon: \"error\",\r\n        title: \"Hubo un error\",\r\n        text: \"Vuelva a intentarlo\"\r\n      });\r\n      if (verificar.error) {\r\n        props.history.push(\"/iniciar-sesion\");\r\n      }\r\n    }\r\n  };\r\n\r\n  //Leer informacion de los inputs de texto/enteros\r\n  const leerInformacionProducto = e => {\r\n    setProducto({\r\n      ...producto,\r\n      [e.target.name]: e.target.value\r\n    });\r\n  };\r\n\r\n  //Coloca la imagen en el state\r\n  const leerArchivo = e => {\r\n    setArchivo(e.target.files[0]);\r\n  };\r\n\r\n  //Spinner de Carga\r\n  if (!producto.nombre) {\r\n    return <Spinner />;\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <h2>Editar Producto</h2>\r\n\r\n      <form onSubmit={handleSubmit}>\r\n        <legend>Llena todos los campos</legend>\r\n\r\n        <div className=\"campo\">\r\n          <label>Nombre:</label>\r\n          <input\r\n            type=\"text\"\r\n            placeholder=\"Nombre Producto\"\r\n            name=\"nombre\"\r\n            onChange={leerInformacionProducto}\r\n            defaultValue={producto.nombre}\r\n          />\r\n        </div>\r\n\r\n        <div className=\"campo\">\r\n          <label>Precio:</label>\r\n          <input\r\n            type=\"number\"\r\n            name=\"precio\"\r\n            min=\"0.00\"\r\n            step=\"0.01\"\r\n            placeholder=\"Precio\"\r\n            onChange={leerInformacionProducto}\r\n            defaultValue={producto.precio}\r\n          />\r\n        </div>\r\n\r\n        <div className=\"campo\">\r\n          <label>Imagen:</label>\r\n          {producto.imagen ? (\r\n            <img\r\n              src={`http://localhost:5000/${producto.imagen}`}\r\n              alt={producto.imagen}\r\n              width=\"300\"\r\n            />\r\n          ) : null}\r\n          <input\r\n            type=\"file\"\r\n            name=\"imagen\"\r\n            onChange={leerArchivo}\r\n            onChange={leerArchivo}\r\n          />\r\n        </div>\r\n\r\n        <div className=\"enviar\">\r\n          <input\r\n            type=\"submit\"\r\n            className=\"btn btn-azul\"\r\n            value=\"Agregar Producto\"\r\n          />\r\n        </div>\r\n      </form>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default withRouter(EditarProducto);\r\n"]},"metadata":{},"sourceType":"module"}